!function($){$.fn.datGallery=function(){return this.each(function(){var e=$(this),t=$("body"),a=$(".gallery .slider"),n=$("#work"),o=n.find(".wrapper"),r,l,c=dataModel.images.length-1,m=dataModel.images.length,d=new TimelineMax,s=function(){p(),g(),f(),M()},p=function(){a.html(Templates.gallery(dataModel)),x()},g=function(){var e=a.find("img");e.on("click",function(){dataModel.currentIndex=e.index($(this)),v(),u()})},f=function(){l=$(Templates.overlay(dataModel))},u=function(){var e=dataModel.images[dataModel.currentIndex],t=$(Templates.image(e));l.find(".imagecontainer .img").html(Templates.fullImage(e)),l.find(".imagecontainer .title").html(Templates.title(e)),l.find(".imagecontainer .meta").html(Templates.meta(e)),l.find(".imagecontainer .description").html(Templates.intro(e)),h(),d.set($(".overlay"),{opacity:0}).set($(".imagecontainer"),{opacity:0}).set($(".title"),{opacity:0}).set($(".img img"),{opacity:0,marginTop:-10}).set($(".meta span"),{marginLeft:-10,opacity:0}).set($(".description"),{marginTop:-15,opacity:0}),d.to($(".overlay"),.6,{opacity:1}).to(o,.6,{className:"+=blur"},"-=0.6").to($(".imagecontainer"),.6,{opacity:1}).to($(".title"),.4,{opacity:1}).staggerTo($(".meta span"),.4,{marginLeft:0,opacity:1},.2).to($(".description"),.6,{marginTop:0,opacity:1}).staggerTo($(".img img"),.4,{opacity:1,marginTop:0},.2)},y=function(){var e=dataModel.images[dataModel.currentIndex],t=$(Templates.image(e));d.to($(".imagecontainer"),.5,{marginLeft:-200,opacity:0,ease:Power1.easeIn,onComplete:function(){l.find(".imagecontainer .img").html(Templates.fullImage(e)),l.find(".imagecontainer .title").html(Templates.title(e)),l.find(".imagecontainer .meta").html(Templates.meta(e)),l.find(".imagecontainer .description").html(Templates.intro(e)),d.set($(".imagecontainer"),{marginLeft:200,opacity:0}),d.to($(".imagecontainer"),.6,{marginLeft:0,opacity:1,scrollTop:0,ease:Power1.easeOut})}})},T=function(){var e=dataModel.images[dataModel.currentIndex],t=$(Templates.image(e));d.to($(".imagecontainer"),.5,{marginLeft:200,opacity:0,ease:Power1.easeIn,onComplete:function(){l.find(".imagecontainer .img").html(Templates.fullImage(e)),l.find(".imagecontainer .title").html(Templates.title(e)),l.find(".imagecontainer .meta").html(Templates.meta(e)),l.find(".imagecontainer .description").html(Templates.intro(e)),d.set($(".imagecontainer"),{marginLeft:-200,opacity:0}),d.to($(".imagecontainer"),.6,{marginLeft:0,opacity:1,scrollTop:0,ease:Power1.easeOut})}})},h=function(){var e=l.find(".identifier");e.html(dataModel.currentIndex+1+" / "+m)},v=function(){t.append(l)},M=function(){l.find(".close").on("click",function(){I()}),l.find(".navright").on("click",function(){dataModel.currentIndex=dataModel.currentIndex<c?dataModel.currentIndex+1:0,y(),h()}),l.find(".navleft").on("click",function(){dataModel.currentIndex=dataModel.currentIndex>0?dataModel.currentIndex-1:c,T(),h()})},I=function(){d.to(o,.6,{className:"-=blur"}).to($(".overlay"),.6,{opacity:0,onComplete:function(){d.set($(".imagecontainer"),{scrollTop:0}),l.detach()}},"-=0.6")},x=function(){var e=0,t=a.find("img"),n=t.length,o=function(){for(var a=$('<div class="slide"></div>'),n=e-4;e>n;n++)a.append(t.eq(n));return a},r=function(){for(var a=$('<div class="slide"></div>'),n=$(".slide").length,i=4*n;e>i;i++)a.append(t.eq(i));return a};for(i=e;i<n;i++)if(e++,e%4===0){var l=o();a.append(l)}else if(e===n){var l=r();a.append(l)}};$(document).keyup(function(e){27==e.keyCode&&I()}),s()})}}(jQuery);